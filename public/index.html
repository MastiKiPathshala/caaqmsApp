<!DOCTYPE html>
<html>
	<head>
	<title>Map - Night Mode</title>
  <meta name="author" content="Taniya Datta">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=yes">

 
  <link rel='stylesheet prefetch' href='css/cjbzr.css'/>
  <link rel='stylesheet prefetch' type="text/css" href="css/style.css"/>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
  <link href="https://fonts.googleapis.com/css?family=Raleway:400,300,600,800,900" rel="stylesheet" type="text/css">
  <link rel="stylesheet" type="text/css" href="http://weloveiconfonts.com/api/?family=entypo"/>

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
  
  <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCAfso6vd-DgN4XaTfwnK-V2iExn9qjJTc&libraries=visualization"></script>
  <script src="js/location.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/prefixfree/1.0.7/prefixfree.min.js"></script>
  <script src="https://cdn.datatables.net/1.10.15/js/jquery.dataTables.min.js"></script>
  <script src="https://cdn.datatables.net/1.10.15/js/dataTables.bootstrap.min.js"></script>

  <script src="https://rawgit.com/kimmobrunfeldt/progressbar.js/1.0.0/dist/progressbar.js"></script>

		<style>
			#map { 
				height: 88%;
				width: 50%;
				min-width: 50%;
				float: left;
				position: absolute;
      	margin-top:5% ;
        min-height:350px;
			}
		    html, body {
        height: 100%;
        background-color: white;
      	}
      	.tablet-view{
      			
      		margin-top: 5%;
          margin-left: 52%;
      		height: 52%;
			    width: 48%;
				  min-width: 40%;
          min-height:350px;
   				overflow-y: scroll;
  				scroll-behavior: smooth;
  				position: relative;
 				 }
 				 .container1 {
  				position:absolute;
  				margin-top: 1%;
  				width: 100%;
  				min-width: 90%;
  				height: 34%;
				}
				#container1 , #container2 ,#container3,#container4,#container5,#container6 {
  				width: 104%;
  				height: 52%;
				}

		</style>

		  <script type="text/javascript">
      $(function(){
        var includes = $('[data-include]');
          jQuery.each(includes, function(){
             var file =$(this).data('include') + '.html';
                $(this).load(file);
    });
  });

  </script>
	</head>
	<body>
	<div data-include="header"></div>
      <div class="row">
  <div class="col-sm-1">
   <!-- Sidebar -->
    <div data-include="sidebar"></div>
  </div>

   <div class="col-sm-11">
 
		<div class="container w3-panel w3-card-2 w3-light-grey" id="map"></div>
		

<div class="container view-block tablet-view w3-panel w3-card-2 w3-light-grey">
   <!--Table-->
  <h3>Alert List</h3>
  <scroll-container>
 	 <table id="table" class="table table-bordered table-hover table-responsive" width="98%">
    	<thead class="thead-inverse">
      	<tr>
        	<th>gatewayId</th>
        	<th>time</th>
        	<th>dataType</th>
        	<th>Alarm Description</th>
        	<th>qualityScore</th>
        	<th>sensorId</th>
     	 </tr>
    	</thead>
  
    	<tbody>
    	</tbody>
  	</table>
  </scroll-container>
</div>

<div class="container1 w3-panel w3-card-2 w3-light-grey" >
	<div class="row">
		<h3 style="margin-left:20px"> Key Performance Indicators</h3>
        <div class="col-sm-2 ">
        <h4> Overall Efficiency</h4>
            <div class="well w3-light-grey " id="container1">
            </div>
        </div>

        <div class="col-sm-2">
        <h4> Availability</h4>
            <div class="well w3-light-grey" id="container2">
            </div>
        </div>
        <div class="col-sm-2">
        <h4> Performance</h4>
            <div class="well w3-light-grey" id="container3">
            </div>
        </div>
        <div class="col-sm-2 ">
        <h4> Quality</h4>
            <div class="well w3-light-grey" id="container4">
            </div>
        </div>
        <div class="col-sm-2">
        <h4> Units per Hour</h4>
            <div class="well w3-light-grey" id="container5">
            </div>
        </div>
        <div class="col-sm-2">
        <h4> kWh per Hour</h4>
            <div class="well w3-light-grey" id="container6">
            </div>
        </div>
    </div>

</div>
</div>
</div>
<script>

$(document).ready(function() {
		
$.ajax({
    method: 'PUT',
    url: '/api/alerts/v1.0/getalerts',
    data: { gatewayId: 'All' , time :'7days' ,dataType :'All'}

    
  }).done(function(data) {

    if (data.status === "OK") { 
      
      for(var i = 0; i < data.results.length; i++){
            //var x=JSON.parse(data.results[i]);
            var row='<tr>',col;
            col = '<td>'+data.results[i].gatewayid+'</td>'+'<td>'+data.results[i].time+'</td>'+'<td>'+data.results[i].dataType+'</td>'+'<td>'+data.results[i].alarmDescription+'</td>'+'<td>'+data.results[i].qualityscore+'</td>'+'<td>'+data.results[i].sensorid+'</td>';
         	 row += col+'</tr>';
          	$('.container #table').append(row);
        	console.log(data.results[i]);
          
    
   }
   $('.container #table').DataTable();
  }
  else{ 
    console.log(data.results);
  }
}).fail(function(data) {
    console.log (data);
});
});
   
 var bar = new ProgressBar.SemiCircle(container1, {
  strokeWidth: 12,
  color: '#FFEA82',
  trailColor: '#000',
  trailWidth: 12,
  easing: 'easeInOut',
  duration: 1400,
  svgStyle: null,
  text: {
    value: '',
    alignToBottom: true
  },
  from: {color: '#FFEA82'},
  to: {color: '#ED6A5A'},
  // Set default step function for all animate calls
  step: (state, bar) => {
    bar.path.setAttribute('stroke', state.color);
    var value = Math.round(bar.value() * 100);
    if (value === 0) {
      bar.setText('');
    } else {
      bar.setText(value+"%");
    }

    bar.text.style.color = '#000';
  }
});
bar.text.style.fontFamily = '"Raleway", Helvetica, sans-serif';
bar.text.style.fontSize = '3rem';

bar.animate(0.4);  // Number from 0.0 to 1.0

var bar2 = new ProgressBar.SemiCircle(container2, {
  strokeWidth: 12,
  color: '#FFEA82',
  trailColor: '#000',
  trailWidth: 12,
  easing: 'easeInOut',
  duration: 1400,
  svgStyle: null,
  text: {
    value: '',
    alignToBottom: true
  },
  from: {color: '#EEEA82'},
  to: {color: '#0c4402'},
  // Set default step function for all animate calls
  step: (state, bar2) => {
    bar2.path.setAttribute('stroke', state.color);
    var value = Math.round(bar2.value() * 100);
    if (value === 0) {
      bar2.setText('');
    } else {
      bar2.setText(value+"%");
    }

    bar2.text.style.color = '#000';
  }
});
bar2.text.style.fontFamily = '"Raleway", Helvetica, sans-serif';
bar2.text.style.fontSize = '3rem';

bar2.animate(0.8); 

var bar3 = new ProgressBar.SemiCircle(container3, {
  strokeWidth: 12,
  color: '#FFEA82',
  trailColor: '#000',
  trailWidth: 12,
  easing: 'easeInOut',
  duration: 1400,
  svgStyle: null,
  text: {
    value: '',
    alignToBottom: true
  },
  from: {color: '#FFEA82'},
  to: {color: '#ED6A5A'},
  // Set default step function for all animate calls
  step: (state, bar3) => {
    bar3.path.setAttribute('stroke', state.color);
    var value = bar3.value() * 100;
    if (value === 0) {
      bar3.setText('');
    } else {
      bar3.setText(value+"%");
    }

    bar3.text.style.color = '#000';
  }
});
bar3.text.style.fontFamily = '"Raleway", Helvetica, sans-serif';
bar3.text.style.fontSize = '3rem';

bar3.animate(0.421);  // Number from 0.0 to 1.0

var bar4 = new ProgressBar.SemiCircle(container4, {
  strokeWidth: 12,
  color: '#FFEA82',
  trailColor: '#000',
  trailWidth: 12,
  easing: 'easeInOut',
  duration: 1400,
  svgStyle: null,
  text: {
    value: '',
    alignToBottom: true
  },
  from: {color: '#EEEA82'},
  to: {color: '#0c4402'},
  // Set default step function for all animate calls
  step: (state, bar4) => {
    bar4.path.setAttribute('stroke', state.color);
    var value = bar4.value() * 100;
    if (value === 0) {
      bar4.setText('');
    } else {
      bar4.setText(value+"%");
    }

    bar4.text.style.color = '#000';
  }
});
bar4.text.style.fontFamily = '"Raleway", Helvetica, sans-serif';
bar4.text.style.fontSize = '3rem';

bar4.animate(0.793); 

var bar5 = new ProgressBar.SemiCircle(container5, {
  strokeWidth: 12,
  color: '#FFEA82',
  trailColor: '#000',
  trailWidth: 12,
  easing: 'easeInOut',
  duration: 1400,
  svgStyle: null,
  text: {
    value: '',
    alignToBottom: true
  },
  from: {color: '#FFEA82'},
  to: {color: '#0c4402'},
  // Set default step function for all animate calls
  step: (state, bar5) => {
    bar5.path.setAttribute('stroke', state.color);
    var value = Math.round(bar5.value() * 100);
    if (value === 0) {
      bar5.setText('');
    } else {
      bar5.setText(value+"%");
    }

    bar5.text.style.color = '#000';
  }
});
bar5.text.style.fontFamily = '"Raleway", Helvetica, sans-serif';
bar5.text.style.fontSize = '3rem';

bar5.animate(0.825);  // Number from 0.0 to 1.0

var bar6= new ProgressBar.SemiCircle(container6, {
  strokeWidth: 12,
  color: '#FFEA82',
  trailColor: '#000',
  trailWidth: 12,
  easing: 'easeInOut',
  duration: 1400,
  svgStyle: null,
  text: {
    value: '',
    alignToBottom: true
  },
  from: {color: '#EEEA82'},
  to: {color: '#0c4402'},
  // Set default step function for all animate calls
  step: (state, bar6) => {
    bar6.path.setAttribute('stroke', state.color);
    var value = Math.round(bar6.value() * 100);
    if (value === 0) {
      bar6.setText('');
    } else {
      bar6.setText(value+"%");
    }

    bar6.text.style.color = '#000';
  }
});
bar6.text.style.fontFamily = '"Raleway", Helvetica, sans-serif';
bar6.text.style.fontSize = '3rem';

bar6.animate(0.742); 
	

	$(document).ready(function() {
	// Initializing locations of all SecurIoT Gateways 
				locationInit();
				
			})
		</script>
		<div data-include="footer"></div>
	</body>
</html>

